var I=Symbol.for("view.fragment");function V(e){return e.type===I||e.type==="Fragment"}function j(e){return typeof e=="object"&&e!==null&&"type"in e&&"props"in e}var q=Symbol.for("view.signalGetter");function p(e){return typeof e=="function"&&e[q]===!0}function A(e){return e===Y}function R(e){let t=e.fallback;if(typeof t=="function")return t;let n=t!=null&&typeof t=="object"&&"type"in t?t:{type:"#text",props:{nodeValue:String(t)},children:[]};return()=>n}function Y(e){return e.children??null}function Z(e){return e.startsWith("v")&&e.length>1?"v"+e.slice(1).replace(/([A-Z])/g,(n,i)=>`-${i.toLowerCase()}`):e}var J=new Set(["vIf","v-if","vElse","v-else","vElseIf","v-else-if","vFor","v-for","vShow","v-show","vText","v-text","vHtml","v-html","vModel","v-model","vOnce","v-once","vCloak","v-cloak"]);function x(e){return!!(J.has(e)||e.startsWith("v")&&e.length>1||e.startsWith("v-"))}function d(e,t){return t in e?!0:Z(t)in e}function m(e){return p(e)?e():e}function w(e){return"vIf"in e||"v-if"in e?"vIf":"vFor"in e||"v-for"in e?"vFor":null}function N(e){let t=e.vIf??e["v-if"];return t==null?!0:!!(typeof t=="function"?t():m(t))}function E(e){return!e}function b(e){let t=e.vElseIf??e["v-else-if"];return t==null?!1:!!(typeof t=="function"?t():m(t))}function $(e){return typeof e=="function"?e:Array.isArray(e)&&e.length===1&&typeof e[0]=="function"?e[0]:()=>e}function D(e,t){let n=e.vFor??e["v-for"];if(n==null)return null;let i=m(n),o=Array.isArray(i)?i:[],u=$(t);return{list:o,factory:u}}function F(e){let t=e.vShow??e["v-show"];return t==null?!0:!!m(t)}function L(e){let t=e.vText??e["v-text"];if(t==null)return"";let n=typeof t=="function"?t():m(t);return n==null?"":String(n)}function _(e){let t=e.vHtml??e["v-html"];if(t==null)return"";let n=typeof t=="function"?t():m(t);return n==null?"":String(n)}var C=new Map;var Q=new Map;function M(e,t){let n=C.get(e);n||(n=[],C.set(e,n)),n.push(t)}function H(e){let t=C.get(e);t&&t.length>0&&t.pop()}function P(e,t){let n=Q.get(e);if(n)return{id:n.id,value:n.getValue(t)}}var re=new Set(["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"]);function O(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function g(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function T(e){if(e==null)return[];if(p(e))return T(e());if(Array.isArray(e)){let t=[];for(let n of e){let i=T(n);for(let o of i)t.push(o)}return t}return j(e)?[e]:[{type:"#text",props:{nodeValue:String(e)},children:[]}]}function ie(e){let t=[];for(let[n,i]of Object.entries(e)){if(n==="children"||n==="key"||n==="ref"||n==="dangerouslySetInnerHTML")continue;if(n==="vCloak"||n==="v-cloak"){t.push('data-view-cloak=""');continue}if(x(n))continue;let o=p(i)?i():i;if(typeof o=="function"||o==null||o===!1)continue;if(o===!0){t.push(g(n));continue}let u;n==="style"&&typeof o=="object"&&o!==null?u=Object.entries(o).map(([h,v])=>`${h.replace(/([A-Z])/g,"-$1").toLowerCase().replace(/^-/,"")}: ${v==null?"":String(v)}`).join("; "):u=String(o),n==="className"?t.push(`class="${g(u)}"`):n==="htmlFor"?t.push(`for="${g(u)}"`):t.push(`${g(n)}="${g(u)}"`)}return t.length?" "+t.join(" "):""}function*a(e,t,n){if(V(e)){let s=t??{lastVIf:!0},f=T(e.props.children??e.children);for(let r of f)yield*a(r,s,n);return}if(typeof e.type=="function"){let s=e.type,f=e.props,r=P(s,f);r&&M(r.id,r.value);try{let c=s(f);if(c==null)return;let y=Array.isArray(c)?c:[c];if(A(s))try{for(let l of y)yield*a(l,t,n)}catch(l){yield*a(R(f)(l),t,n)}else for(let l of y)yield*a(l,t,n)}finally{r&&H(r.id)}return}let i=e.type;if(i==="#text"){yield O(String(e.props.nodeValue??""));return}let o=e.props,u=w(o);if(d(o,"vElse")){if(t&&!E(t.lastVIf))return;t&&(t.lastVIf=!0)}if(d(o,"vElseIf")){if(t&&t.lastVIf)return;if(!b(o)){t&&(t.lastVIf=!1);return}t&&(t.lastVIf=!0)}if(u==="vIf"){if(!N(o)){t&&(t.lastVIf=!1);return}t&&(t.lastVIf=!0)}if(u==="vFor"){let s=o.children??e.children,f=D(o,s);if(f){let{list:r,factory:c}=f,y={...o,vFor:void 0,"v-for":void 0};for(let l=0;l<r.length;l++){let S=c(r[l],l),k=Array.isArray(S)?S:[S],W=k[0],U={type:i,props:{...y,children:k.length===1?k[0]:k},key:W?.key!=null?W.key:l};yield*a(U,t,n)}}return}let h=ie(o);d(o,"vShow")&&(F(o)||(h+=' style="display:none"')),e.key!=null&&e.key!==void 0&&(h+=` data-key="${g(String(e.key))}"`);let v=t??{lastVIf:!0};if(yield`<${i}${h}>`,!re.has(i.toLowerCase())){if(d(o,"vText"))yield O(L(o));else if(d(o,"vHtml")){let s=_(o);yield n?.allowRawHtml===!1?O(s):s}else{let s=T(o.children??e.children);if(s.some(r=>r.key!=null&&r.key!==void 0))for(let r=0;r<s.length;r++){let c=s[r],y=c.key!=null&&c.key!==void 0?String(c.key):`@${r}`;yield`<span data-view-keyed data-key="${g(y)}">`,yield*a(s[r],v,n),yield"</span>"}else for(let r of s)yield*a(r,v,n)}yield`</${i}>`}}function kt(e,t){let n=e();return a(n,void 0,t)}export{kt as renderToStream};
//# sourceMappingURL=stream.js.map
